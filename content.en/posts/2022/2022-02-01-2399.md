---
title: How to Resolve "Cannot Unregister the Machine While It Is Locked" Error in Vagrant
author: Shafiq Alibhai
date: 2022-02-01T09:05:56+00:00
categories:
  - Development
---

When working with Vagrant, a tool for building and managing virtual environments, you may encounter an error message that reads "Cannot unregister the machine while it is locked." This is often accompanied by a block of error messages and command output, as shown below:

```bash
vagrant destroy
default: Are you sure you want to destroy the 'default' VM? [y/N] y
==> default: Destroying VM and associated drivesâ€¦
There was an error while executing VBoxManage, a CLI used by Vagrant for controlling VirtualBox.
...
VBoxManage: error: Cannot unregister the machine 'CnC_default_1643660523119_45689' while it is locked
...
```

This error is usually thrown when attempting to destroy a Vagrant virtual machine (VM) using the `vagrant destroy` command. It signifies that the virtual machine is in a locked state, preventing it from being unregistered and deleted.

## Solution

The issue can be resolved by manually terminating any running instances of VirtualBox before running the `vagrant destroy` command again. The following command can be executed to kill all instances of `VBoxHeadless`, which is the process responsible for running virtual machines in headless mode:

```bash
killall -9 VBoxHeadless && vagrant destroy
```

This command will forcibly terminate any running `VBoxHeadless` processes and then execute the `vagrant destroy` command to remove the VM.

## Understanding the Command

Let's break down what this command does:

- `killall -9 VBoxHeadless`: The `killall` command sends a signal to terminate all processes with the specified name, in this case, `VBoxHeadless`. The `-9` flag sends the `SIGKILL` signal, which forcefully kills the process.
  
- `&&`: This is a shell operator that allows you to execute a second command only if the first command executes successfully.

- `vagrant destroy`: This is the command to destroy the Vagrant virtual machine, which should now execute without any issues.

Encountering errors while working with Vagrant can be frustrating, but understanding how to resolve them efficiently will save you time and effort. The "Cannot unregister the machine while it is locked" error can be easily fixed by using a combination of `killall` and `vagrant destroy` commands, enabling you to proceed with your development tasks smoothly.
